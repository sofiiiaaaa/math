---
sidebar_position: 8
---

# Элементы теории корреляции

import Figure from '@components/Figure'

import Formula from '@components/Formula'

import Highlight from '@components/Highlight'

import useBaseUrl from '@docusaurus/useBaseUrl';

При обработке наблюдений над двумя и более случайными величинами возникают вопросы, связанные с оценкой этих случайных
величин, нахождением для них числовых характеристик, оценкой их точности и надежности. Однако для системы двух случайных
величин этих характеристик недостаточно. Надо ещё знать, как тесно связаны эти величины. Для этого находят
корреляционный момент $K_{xy}$, равный математическому ожиданию произведения отклонений:

$$
K_{xy}=M\{[x_i-M(x)][y_i-M(y)\}
$$

и коэффициент корреляции, характеризующий эту связь:

$$
r_{xy}=\cfrac{K_{xy}}{\sigma_x \sigma_y}
$$

В качестве примера рассмотрим зависимость роста и веса студентов, учащихся на одном курсе. Очевидно, что увеличение
роста (случайная величина $X$) будет вызывать увеличение веса (случайная величина $Y$) студента. Однако эта зависимость
не является однозначной. Так, при одном и том же росте можно наблюдать людей с различным весом. Происходит разброс
значений $Y$ при одном и том же значении $X$. Вместе с тем, как показывает опыт, средний вес является функцией роста,
т.е. $X$ и $Y$ связаны статистически.

**Определение**. Если при изменении одной из случайных величин изменяется среднее значение другой, то такую
статистическую зависимость называют _корреляционной_.

Данные наблюдений над случайной двумерной величиной $(X, Y)$ заносят в корреляционную таблицу. Например, в таблице ниже
приведена выборка объема $n=100$ из нормальной двумерной генеральной совокупности , характеризующей зависимость веса от
роста:

| $Y\space\diagdown  X$ | 160 | 165 | 170 | 175 | 180 | 185 |  $n_y$  |
| --------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-----: |
| **60**                |  5  |  1  |  -  |  -  |  -  |  -  |    6    |
| **65**                |  -  |  6  |  2  |  -  |  -  |  -  |    8    |
| **75**                |  -  |  -  |  5  | 40  |  5  |  -  |   50    |
| **80**                |  -  |  -  |  2  |  8  |  7  |  -  |   17    |
| **90**                |  -  |  -  |  -  |  4  |  7  |  8  |   19    |
| $n_x$                 |  5  |  7  |  9  | 52  | 19  |  8  | $n=100$ |

Средние значения составляющих $X$ и $Y$ находим по формулам:

$$
\bar{x} = \cfrac{\displaystyle\sum_{i=1}^n n_{x_{i}}x_i}{n}; \bar{y}=\cfrac{\displaystyle\sum_{i=1}^n n_{y_{i}}y_i}{n}
$$

При корреляционной зависимости изменение одной величины вызывает изменение условного среднего значения другой, т.е.

$$
\bar{y}(x) = f(x) \space \text{или} \space \bar{x}(y)=\phi(y)
$$

Эти уравнения называются уравнениями регрессии $Y$ на $X$ или $X$ на $Y$, а их графики – линиями регрессии.

По опытным данным находят для каждого значения $x_i$ условные средние $\bar{y}_i$, строят точки
$M_i(x_i;\space\bar{y}_i)$ в системе координат $(x, \bar{y})$ и соединяют их ломаной линией. Полученная линия называется
_эмпирической линией регрессии_ $Y$ на $X$.

Для приведенной выше таблицы найдем средние значения $y_i$ для всех значений $x_i$:

| $x_i$     | $y_i$                                                                 |
| --------- | --------------------------------------------------------------------- |
| $x_1=160$ | $\bar{y}_1=\cfrac{60\cdot 5}{5} = 60$                                 |
| $x_2=165$ | $\bar{y}_2=\cfrac{60\cdot 1 + 65 \cdot 6}{7} = 64.3$                  |
| $x_3=170$ | $\bar{y}_3=\cfrac{65\cdot 2 + 75 \cdot 5 + 80 \cdot 2}{9} = 73.9$     |
| $x_4=175$ | $\bar{y}_4=\cfrac{75\cdot 40 + 80 \cdot 8 + 90 \cdot 4}{52} = 76.9.3$ |
| $x_5=180$ | $\bar{y}_5=\cfrac{5\cdot 75 + 80 \cdot 7 + 90 \cdot 7}{19} = 82.4$    |
| $x_6=185$ | $\bar{y}_6=\cfrac{90\cdot 8}{8} = 90$                                 |

Если число опытов сколько угодно увеличивать, то была бы получена теоретическая линия регрессии. На практике этого
сделать нельзя. Поэтому теоретическая линия регрессии не совпадает с опытной. По форме опытной линии регрессии
определяют вид теоретической линии регрессии. В нашем примере ближе к точкам лежит некоторая прямая L, которая и
является теоретической линией регрессии.

<Figure description=""> 
<img src={useBaseUrl("/img/module-03/cor.png")} /> 
</Figure>

Выборочное уравнение прямой линии регрессии $Y$ на $X$ имеет вид:

<Formula description="(30)">

$\bar{y}_x = \bar{y} + r \cdot \cfrac{\sigma_x}{\sigma_y}\cdot (x - \bar{x})$

</Formula>

где

- $\bar{y}_x$ &mdash; условная средняя;
- $\bar{x}$ и $\bar{y}$ &mdash; выборочные средние признаков $X$ и $Y$;
- $\sigma_x$ и $\sigma_y$ &mdash; выборочные среднеквадратические отклонения;
- $r$ выборочный коэффициент корреляции, равный

$$
r = \cfrac{\displaystyle\sum n_{xy}\cdot x\cdot y - n\cdot\bar{x}\cdot\bar{y}}{n\cdot\sigma_x\cdot\sigma_y}
$$

Выборочный коэффициент корреляции применяется для оценки прямолинейной корреляционной зависимости $y$ от $x$.

Если $r=0$, то линейной корреляционной зависимости нет. При этом возможна нелинейная корреляция. Если $0.3 < |r| < 0.7$
&mdash; то корреляционная связь слабая, если $0.7 < |r| < 1$ &mdash; то корреляционная связь сильная. Если же $|r|=0$ -
корреляционная связь переходит в функциональную.

Если данные наблюдений над признаками $X$ и $Y$ заданы в виде корреляционной таблицы, например как в нашей, то
целесообразно перейти к условным вариантам

$$
u_i = \cfrac{x_i - C_x}{h_x}; \space v_i=\cfrac{y_i - C_y}{h_y}
$$

где:

- $h_x, h_y$ &mdash; шаги вариант $X$ и $Y$, т.е. разности между двумя соседними значениями вариант $X$ и $Y$
  соответственно;
- $C_x,C_y$ &mdash; _ложные нули_ вариант $X$ и $Y$ соответственно. Отметим, что в качестве _ложного нуля_ рекомендуется
  принимать варианту, которая расположена в середине вариационного ряда и имеет наибольшую частоту.

Выборочный коэффициент корреляции $r$ в случае применения условных вариант вычисляется по формуле

$$
r=\cfrac{\displaystyle\sum n_{uv}\cdot u \cdot v - n \cdot\bar{u}\cdot\bar{v}}{n\cdot\sigma_u\cdot\sigma_v}
$$

Величины $\bar{u}, \bar{v}, \sigma_x, \sigma_y$ находятся по формулам

$$
\bar{u}=\cfrac{\displaystyle\sum u_i n_{u_i}}{n}
$$

$$
\bar{v}=\cfrac{\displaystyle\sum v_i n_{v_i}}{n}
$$

$$
\sigma_u = \sqrt{\bar{u^2} - (\bar{u})^2}
$$

$$
\sigma_v = \sqrt{\bar{v^2} - (\bar{v})^2}
$$

Зная эти величины, можно определить входящие в уравнение регрессии (30) величины по формулам:

$$
\bar{x} = \bar{u} \cdot h_x + C_x, \bar{y} = \bar{v} \cdot h_y + C_y
$$

$$
\sigma_x = \sigma_u \cdot h_x, \sigma_y = \sigma_v \cdot h_y
$$

Перейдем к практической части. Найдем уравнение регрессии $y$ на $x$ и оценим тесноту корреляционной связи для случайных
величин, приведенных выше в таблице.

Введем условные варианты: $u_i = \cfrac{x_i - 175}{5}; v_i = \cfrac{y_i - 75}{5}$

Уравнение прямой линии регрессии имеет вид:

$$
\bar{y}(x) - \bar{y} = \rho_{y/x}(x - \bar{x})
$$

Средние значения $X$ и $Y$ найдем методом произведений.

|       | 1   | 2   | 3   | 4   | 5   | 6   |
| ----- | --- | --- | --- | --- | --- | --- |
| $u_i$ | -3  | -2  | -1  | 0   | 1   | 2   |
| $n_x$ | 5   | 7   | 9   | 52  | 19  | 8   |

$$
\bar{x} = h_1 \bar{u} + C_1
$$

$$
\bar{u}=\cfrac{\displaystyle\sum u_i n_{x_i}}{100} = \cfrac{-3 \cdot 5 - 2 \cdot 1 - 1 \cdot 9 + 19 + 16}{100} = - \cfrac{3}{100} = -0.03
$$

$$
\bar{x} = 5(-0.03) + 175 = 174.5
$$

|       | 1   | 2   | 3   | 4   | 5   |
| ----- | --- | --- | --- | --- | --- |
| $v_i$ | -3  | -2  | 0   | 1   | 2   |
| $n_y$ | 6   | 8   | 50  | 17  | 19  |

$$
\bar{y} = h_2 \bar{v} + C_2
$$

$$
\bar{v}=\cfrac{\displaystyle\sum v_i n_{y_i}}{100} = \cfrac{-3 \cdot 6 - 2 \cdot 8 + 17 + 38}{100} = \cfrac{21}{100} = 0.21
$$

$$
\bar{y} = 5(0.21) + 75 = 76.05
$$

Коэффициент $\rho_{y/x}$ в условных вариантах имеет вид:

$$
\rho_{y/x} = \rho_{v/u} = \cfrac{\overline{uv} - \bar{u}\cdot\bar{v}}{[\sigma(u)]^2}
$$

Для нахождения $\overline{uv}$ составим таблицу условных вариант:

| $V\space\diagdown U$ | -3  | -2  | -1  |  0  |  1  |  2  |  $n_v$  |
| -------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-----: |
| **-3**               |  5  |  1  |  -  |  -  |  -  |  -  |    6    |
| **-2**               |  -  |  6  |  2  |  -  |  -  |  -  |    8    |
| **0**                |  -  |  -  |  5  | 40  |  5  |  -  |   50    |
| **1**                |  -  |  -  |  2  |  8  |  7  |  -  |   17    |
| **2**                |  -  |  -  |  -  |  4  |  7  |  8  |   19    |
| $n_u$                |  5  |  7  |  9  | 52  | 19  |  8  | $n=100$ |

$$
\overline{uv}=\cfrac{\displaystyle\sum n_{uv}uv}{100}=1.3
$$

Для нахождения $\sigma(u)$ необходимо вычислить $\bar{u^2}$:

$$
\bar{u^2} = \cfrac{9 \cdot 5 + 4 \cdot 7 + 1 \cdot 9 + 1 \cdot 19 + 4 \cdot 8}{100} = 1.33
$$

$$
\sigma^2(u) = \bar{u^2} - (\bar{u})^2 = 1.33 - (-0.03)^2=1.329
$$

$$
\sigma(u)=1.14
$$

Для нахождения $\sigma(u)$ коэффициента корреляции необходимо вычислить . Найдем $\bar{v^2}$:

$$
\bar{v^2} = \cfrac{9 \cdot 6 + 4 \cdot 8 + 17 + 4 \cdot 19}{100} = 1.79
$$

$$
\sigma(v) = \sqrt{1.79 - (0.21)^2} = \sqrt{1.74} = 1.32
$$

Найдем коэффициент прямой регрессии:

$$
\rho_{y/x} = \cfrac{1.3 - (-0.03)\cdot 0.21}{1.329} = 0.98
$$

Уравнение прямой линии регрессии:

$$
\bar{y}(x) - 76.05 = 0.98(x - 174.85)
$$

Найдем коэффициент корреляции

$$
r_{xy}=\rho_{v/u}\cfrac{\sigma(u)}{\sigma(v)} = 0.98 \cfrac{1.14}{1.32} \cong 0.84
$$

Так как $r_{xy}=0.84 > 0.7$, то между $X$ и $Y$ имеет место сильная линейная корреляционная зависимость.
